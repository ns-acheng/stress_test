C:\git\stress_test>python poc_power.py 1

============================================================
S0 Modern Standby Wake Timer PoC
============================================================

✓ Running with administrator privileges
✓ Selected Mode: 1
✓ Wake delay: 10 seconds

Step 1: Creating scheduled task with wake timer...
------------------------------------------------------------
✓ Created completion script: poc_wake_complete.py
✓ Wake timer enabled for task
✓ Trigger set for: 2025-12-28 08:05:18
✓ Wake action: Run poc_wake_complete.py
✓ Scheduled task 'WakeFromS0_PoC' created successfully
Win32 exception occurred releasing IUnknown at 0x000002132D8E6FA0
Win32 exception occurred releasing IUnknown at 0x000002132D8E6BC0
Win32 exception occurred releasing IUnknown at 0x000002132D8E5DE0
Win32 exception occurred releasing IUnknown at 0x000002132D8E5BF0
Win32 exception occurred releasing IUnknown at 0x000002132D8E5910

✓ Wake timer successfully registered with system
  The RTC alarm will trigger in 10 seconds, even during sleep


Step 2: Entering Modern Standby...
------------------------------------------------------------

============================================================
Mode 1: Exit-and-Resume (Script exits, wake timer completes)
Entering Modern Standby in 3 seconds...
System will wake after 10 seconds
============================================================

Sleep initiated at: 08:05:11
✓ Monitor turned OFF (S0 sleep mode)

✓ Script exiting - wake timer will complete the cycle

============================================================
Mode 1: Script completed (wake handled by scheduled task)
============================================================


C:\git\stress_test>python poc_power.py 2

============================================================
S0 Modern Standby Wake Timer PoC
============================================================

✓ Running with administrator privileges
✓ Selected Mode: 2
✓ Wake delay: 10 seconds

Step 1: Creating scheduled task with wake timer...
------------------------------------------------------------
Deleted existing task: WakeFromS0_PoC
✓ Wake timer enabled for task
✓ Trigger set for: 2025-12-28 08:05:59
✓ Wake action: Run util_wakeup.py
✓ Scheduled task 'WakeFromS0_PoC' created successfully
Win32 exception occurred releasing IUnknown at 0x0000022A03416FA0
Win32 exception occurred releasing IUnknown at 0x0000022A03416BC0
Win32 exception occurred releasing IUnknown at 0x0000022A03415DE0
Win32 exception occurred releasing IUnknown at 0x0000022A03415BF0
Win32 exception occurred releasing IUnknown at 0x0000022A03415910

✓ Wake timer successfully registered with system
  The RTC alarm will trigger in 10 seconds, even during sleep


Step 2: Entering Modern Standby...
------------------------------------------------------------

============================================================
Mode 2: Wait-for-Wake (No countdown, accepts manual wake)
Entering Modern Standby in 3 seconds...
Press any key after 10 seconds to complete wake
============================================================

Sleep initiated at: 08:05:52
✓ Monitor turned OFF (S0 sleep mode)

Waiting for wake event (hardware will wake at 08:06:02)...
Press any key after wake timer triggers to resume script



✓ System resumed at: 08:06:50
✓ Total duration: 57.72 seconds
✓ Wake timer triggered (expected ~10s, actual 57.72s)

Forcing display wake...
✓ Display wake completed

============================================================
System woke up from Modern Standby!
============================================================

✓ Cleaned up scheduled task

C:\git\stress_test>python poc_power.py 3

============================================================
S0 Modern Standby Wake Timer PoC
============================================================

✓ Running with administrator privileges
✓ Selected Mode: 3
✓ Wake delay: 10 seconds

Step 1: Creating scheduled task with wake timer...
------------------------------------------------------------
✓ Wake timer enabled for task
✓ Trigger set for: 2025-12-28 08:07:19
✓ Wake action: Run util_wakeup.py
✓ Scheduled task 'WakeFromS0_PoC' created successfully
Win32 exception occurred releasing IUnknown at 0x000002A74BDC6FA0
Win32 exception occurred releasing IUnknown at 0x000002A74BDC6BC0
Win32 exception occurred releasing IUnknown at 0x000002A74BDC5DE0
Win32 exception occurred releasing IUnknown at 0x000002A74BDC5BF0
Win32 exception occurred releasing IUnknown at 0x000002A74BDC5910

✓ Wake timer successfully registered with system
  The RTC alarm will trigger in 10 seconds, even during sleep


Step 2: Entering Modern Standby...
------------------------------------------------------------

============================================================
Mode 3: Demo Mode (Monitor off, no system suspend)
Demonstrating wake timer functionality
System will wake after 10 seconds
============================================================

Demo started at: 08:07:12
✓ Monitor turned OFF

Waiting 10 seconds for wake timer to trigger...

Timer check: 9.1s until wake event

✓ Timer completed at: 08:07:51
✓ Duration: 38.64 seconds
✓ Wake timer should have triggered in background

Forcing display wake...
✓ Display restored

============================================================
System woke up from Modern Standby!
============================================================

✓ Cleaned up scheduled task



