============================================================
S0 Modern Standby Service-Based Wake Demo
============================================================

This will:
  1. Install StressTestWakeService (if needed)
  2. Enter S0 Modern Standby for 10 seconds
  3. Automatically wake without user input
  4. Report wake timing and drift

Note: Requires administrator privileges
============================================================

Press Enter to start demo...

2025-12-28 10:14:42,401 - INFO - Enabling wake privileges...
2025-12-28 10:14:42,401 - INFO - Enabling 'Allow wake timers' in Power Settings...
2025-12-28 10:14:42,537 - INFO - Wake timers successfully enabled.
2025-12-28 10:14:42,537 - INFO - Starting S0 wake test...

2025-12-28 10:14:42,539 - INFO - Entering S0 Modern Standby with service-managed wake (10s)...
2025-12-28 10:14:42,558 - INFO - Wake schedule written to power.json: 10s
2025-12-28 10:14:42,558 - INFO - Turning monitor OFF (entering S0)...
2025-12-28 10:14:42,559 - INFO - S0 sleep initiated at 10:14:42
2025-12-28 10:14:42,559 - INFO - Wake timer will trigger in 10s...
2025-12-28 10:14:42,559 - INFO - Waiting for wake completion (timeout: 70s)...
2025-12-28 10:15:09,923 - INFO - Wake completed successfully
2025-12-28 10:15:09,923 - INFO - Wake duration: 27.16s (expected: 10s, drift: 17.16s)
2025-12-28 10:15:09,925 - INFO - [OK] Wake completed successfully after 27.37s
2025-12-28 10:15:09,925 - INFO - Forcing display wake...
2025-12-28 10:15:09,927 - INFO - Display wake completed

============================================================
[OK] Demo completed successfully!
  - Service auto-installed and started
  - S0 sleep initiated
  - Automatic wake triggered
  - No manual input required
============================================================


Service Status:

SERVICE_NAME: StressTestWakeService
        TYPE               : 10  WIN32_OWN_PROCESS
        STATE              : 4  RUNNING
                                (STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)
        WIN32_EXIT_CODE    : 0  (0x0)
        SERVICE_EXIT_CODE  : 0  (0x0)
        CHECKPOINT         : 0x0
        WAIT_HINT          : 0x0

